from eth_hash.auto import (
    keccak,
)

target: list = ["32cefdcd8e794145c9af8dd1f4b1fbd92d6e547ae855553080fc8bd19c4883a0",
                "2304e88f144ae9318c71b0fb9e0f44bd9e0c6c58fb1b5315a35fd8b4b2a444ab",
                "60a73bfb121a98fb6b52dfb29eb0defd76b60065b8cf07902baf28c167d24daf",
                "ea00237ef11bd9615a3b6d2629f2c6259d67b19bb94947a1bd739bae3415141c",
                "f1918e8562236eb17adc8502332f4c9c82bc14e19bfc0aa10ab674ff75b3d2f3",
                "a8982c89d80987fb9a510e25981ee9170206be21af3c8e0eb312ef1d3382e761"]
target_index: dict = {target[i]: i for i in range(len(target))}
0x65
0x64
0x69
0x73
0x70
0x757073696465
0xa8982c89d80987fb9a510e25981ee9170206be21af3c8e0eb312ef1d3382e761
0xf1918e8562236eb17adc8502332f4c9c82bc14e19bfc0aa10ab674ff75b3d2f3
0xea00237ef11bd9615a3b6d2629f2c6259d67b19bb94947a1bd739bae3415141c
0x60a73bfb121a98fb6b52dfb29eb0defd76b60065b8cf07902baf28c167d24daf
0x2304e88f144ae9318c71b0fb9e0f44bd9e0c6c58fb1b5315a35fd8b4b2a444ab
0x32cefdcd8e794145c9af8dd1f4b1fbd92d6e547ae855553080fc8bd19c4883a0

def is_target(h: str) -> bool:
    return h in target_index.keys()


def int_to_keccak(s: str) -> str:
    # integer failed to find the target
    return keccak(s.encode()).hex()


def hex_to_keccak(s: str) -> str:
    return keccak(bytes.fromhex(s)).hex()


if __name__ == "__main__":
    input_list = range(256)
    print(hex_to_keccak("01"))
    for s in input_list:
        s = hex(s)[2:].zfill(2)
        res = hex_to_keccak(s)
        if is_target(res):
            print(target_index.get(res), s)

# 64
# 65
# 69
# 70
# 73
# 75


  0x65
  0x64
  0x69
  0x73
  0x70
  0x75

# 0x757370696564


cast send \
--rpc-url  http://host3.dreamhack.games:12936/e48d1a4c6d1e/rpc \
--private-key 0x4f5cdcf2629c550b7c8f5ab27d7a405a703b115c8401cb8d765f7b39671776f5 \
0xeE20fe660442d837C249C6b3BB67674F4bAe9ab9 \
"giveMeFlag(uint, bytes)" 31337 "0x757073696465"