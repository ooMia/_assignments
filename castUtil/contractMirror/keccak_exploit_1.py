from eth_hash.auto import (
    keccak,
)

target: list = [
    "32cefdcd8e794145c9af8dd1f4b1fbd92d6e547ae855553080fc8bd19c4883a0",
    "2304e88f144ae9318c71b0fb9e0f44bd9e0c6c58fb1b5315a35fd8b4b2a444ab",
    "60a73bfb121a98fb6b52dfb29eb0defd76b60065b8cf07902baf28c167d24daf",
    "ea00237ef11bd9615a3b6d2629f2c6259d67b19bb94947a1bd739bae3415141c",
    "f1918e8562236eb17adc8502332f4c9c82bc14e19bfc0aa10ab674ff75b3d2f3",
    "a8982c89d80987fb9a510e25981ee9170206be21af3c8e0eb312ef1d3382e761", ]

target_index: dict = {target[i]: i for i in range(len(target))}


def is_target(h: str) -> bool:
    return h in target_index.keys()


def int_to_keccak(s: str) -> str:
    # integer failed to find the target
    return keccak(s.encode()).hex()


def hex_to_keccak(s: str) -> str:
    return keccak(bytes.fromhex(s)).hex()


if __name__ == "__main__":
    res: list = ["" for _ in range(6)]
    for s in range(256):
        s = hex(s)[2:].zfill(2)
        kec = hex_to_keccak(s)
        if is_target(kec):
            idx = target_index.get(kec)
            print(idx, s, kec)
            res.insert(idx, s)

    print("".join(res))
